# code
CMSEL,ALL
*GET,EMAX,ELEM„NUM,MAX
*GET,EMIN,ELEM„NUM,MIN
ALLSEL
TIME_WELD=5.9
Time_inc=0.2
CSI2=0.88
CSI3=24
CSI4=220
Ro=5
Yi=10
Vel=6.67
YY=0.5
τ=0
Pi=3.14
NPT=TIME_WELD/Time_inc
NROPT, FULL
*DO,i,1,NPT,1
WTIME=(i*Time_inc)
TIME,WTIME
*DO,jj,EMIN,EMAX,1
82X=CENTRX(jj)
Y=CENTRY(jj)
Z=CENTRZ(jj)
CSI=Z+Vel*(τ-WTIME)
RT=sqrt(X**2+CSI**2)
*IF,RT,GT,Ro,THEN
Q=0
*ELSEIF,Y,GE,YY,THEN
Qo=(3*CSI2*CSI3*CSI4)/Pi*(Ro**2)
Qv=exp((-3)*(RT**2)/(Yi)**2)
Q=Qo*Qv
*ELSE
Q=0
*ENDIF
BFE,jj,HGEN„Q
*ENDDO
NSUB, 1, 1, 1
SOLVE
*ENDDO
CMSEL,ALL
BFEDELE,ALL,ALL
ALLSEL
Cooling_time=1000
TIME,Cooling_time
NSUBST,1000,1000,1000
SOLVE
